<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Perl的正则表达式（三）</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Li,Gongfu">

    <!-- Le styles -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="/theme/css/font-awesome.css" rel="stylesheet">

    <link href="/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png">

    <link href="/" type="application/atom+xml" rel="alternate" title="晓新's Blog ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">晓新's Blog </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>
                  <li >
                    <a href="/category/fen-bu-shi.html">
						<i class="icon-folder-open icon-large"></i>分布式
					</a>
                  </li>
                  <li >
                    <a href="/category/java.html">
						<i class="icon-folder-open icon-large"></i>JAVA
					</a>
                  </li>
                  <li >
                    <a href="/category/machine-learning.html">
						<i class="icon-folder-open icon-large"></i>Machine Learning
					</a>
                  </li>
                  <li class="active">
                    <a href="/category/perl.html">
						<i class="icon-folder-open icon-large"></i>Perl
					</a>
                  </li>
                  <li >
                    <a href="/category/python.html">
						<i class="icon-folder-open icon-large"></i>Python
					</a>
                  </li>
                  <li >
                    <a href="/category/scala.html">
						<i class="icon-folder-open icon-large"></i>Scala
					</a>
                  </li>
                  <li >
                    <a href="/category/shu-ju-ku.html">
						<i class="icon-folder-open icon-large"></i>数据库
					</a>
                  </li>
                  <li >
                    <a href="/category/technology.html">
						<i class="icon-folder-open icon-large"></i>Technology
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Perl的正则表达式（三）">
                                        Perl的正则表达式（三）
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2014-12-03T16:20:00">
        <i class="icon-calendar"></i>三 03 十二月 2014
</abbr>
<span class="label">By</span>
<a href="/author/ligongfu.html"><i class="icon-user"></i>Li,Gongfu</a>
<span class="label">Category</span>
<a href="/category/perl.html"><i class="icon-folder-open"></i>Perl</a>.


<span class="label">Tags</span>
	<a href="/tag/zheng-ze-biao-da-shi.html"><i class="icon-tag"></i>正则表达式</a>
</footer><!-- /.post-info -->                </div>
                <h3>用s///进行替换</h3>
<p>把存在变量中匹配模式的那部分内容替换成另一个字符串，如果匹配失败，则什么都不会发生.s///返回的是布尔值，替换成功时为真，否则为假。</p>
<div class="highlight"><pre><span class="err">$</span><span class="n">_</span> <span class="o">=</span> <span class="s">&quot;green scaly dinosaur&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span> <span class="p">(</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span><span class="o">/</span><span class="err">$</span><span class="mi">2</span><span class="p">,</span> <span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="p">;</span>  <span class="o">=&gt;</span><span class="s">&quot;scaly, green dinosaur&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/^/</span><span class="n">huge</span><span class="p">,</span> <span class="o">/</span><span class="p">;</span>    <span class="o">=&gt;</span><span class="s">&quot;huge, scaly, green dinosaur&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/</span><span class="p">,.</span><span class="o">*</span><span class="n">een</span><span class="c1">//;     =&gt;&quot;huge dinosaur&quot;;</span>
<span class="n">s</span><span class="o">/</span><span class="n">green</span><span class="o">/</span><span class="n">red</span><span class="o">/</span><span class="p">;</span>   <span class="o">=&gt;</span><span class="s">&quot;huge dinosaur&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="err">$</span><span class="o">/</span><span class="p">(</span><span class="err">$`</span><span class="o">!</span><span class="p">)</span><span class="err">$</span><span class="o">&amp;/</span><span class="p">;</span><span class="o">=&gt;</span><span class="s">&quot;huge (huge !)dinosaur&quot;</span><span class="p">;</span>
</pre></div>


<h3>/g全局替换</h3>
<p>s///只会进行一次替换，s///g则会进行所有可能的的替换。我们常常会需要缩减空白，即把任何连续的空白转换成单一空格：</p>
<div class="highlight"><pre><span class="err">$</span><span class="n">_</span> <span class="o">=</span> <span class="s">&quot;Input    data</span><span class="se">\t</span><span class="s"> may have extra     whitespace.&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/</span><span class="err">\</span><span class="n">s</span><span class="o">+/</span> <span class="o">/</span><span class="n">g</span><span class="p">;</span>
</pre></div>


<p>另一个常用的例子是去除掉行首和行尾的空白符：</p>
<div class="highlight"><pre><span class="n">s</span><span class="o">/^</span><span class="err">\</span><span class="n">s</span><span class="o">+|</span><span class="err">\</span><span class="n">s</span><span class="o">+</span><span class="err">$</span><span class="c1">//g;</span>
</pre></div>


<h3>无损替换</h3>
<p>s///会直接对原始字符串进行替换，返回成功替换的次数。如果用r修饰符，会保留原始字符串，而返回替换过后的字符串。</p>
<div class="highlight"><pre><span class="k">my</span> <span class="nv">$original</span> <span class="o">=</span> <span class="s">&#39;fred ate 1 rib&#39;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$copy</span> <span class="o">=</span> <span class="nv">$original</span> <span class="o">=~</span> <span class="sr">s/\d+ ribs?/10 ribs/</span><span class="n">r</span><span class="p">;</span>
</pre></div>


<h3>大小写转换</h3>
<p>在替换运算中，常常需要把替换的单词改写成全部大写或小写。</p>
<ul>
<li>\U：全大写</li>
<li>\L：全小写</li>
<li>\l:    只影响后面紧跟的第一个字符，小写</li>
<li>\u：首字母大写</li>
</ul>
<div class="highlight"><pre><span class="err">$</span><span class="n">_</span> <span class="o">=</span> <span class="s">&quot;I saw Barney with Fred .&quot;</span><span class="p">;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">fred</span><span class="o">|</span><span class="n">barney</span><span class="p">)</span><span class="o">/</span><span class="err">\</span><span class="n">U</span><span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="n">gi</span><span class="p">;</span>  <span class="o">=&gt;</span><span class="s">&quot;I saw BARNEY with FRED .&quot;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">fred</span><span class="o">|</span><span class="n">barney</span><span class="p">)</span><span class="o">/</span><span class="err">\</span><span class="n">L</span><span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="n">gi</span><span class="p">;</span>  <span class="o">=&gt;</span><span class="s">&quot;I saw barney with fred .&quot;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span> <span class="n">with</span> <span class="p">(</span><span class="err">\</span><span class="n">w</span><span class="o">+</span><span class="p">)</span><span class="o">/</span><span class="err">\</span><span class="n">U</span><span class="err">$</span><span class="mi">2</span><span class="err">\</span><span class="n">E</span> <span class="n">with</span> <span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="n">i</span><span class="p">;</span> <span class="o">=&gt;</span><span class="s">&quot;I saw FRED with barney .&quot;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">fred</span><span class="o">|</span><span class="n">barney</span><span class="p">)</span><span class="o">/</span><span class="err">\</span><span class="n">u</span><span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="n">gi</span><span class="p">;</span> <span class="o">=&gt;</span><span class="s">&quot;I saw FRED with Barney .&quot;</span>
<span class="n">s</span><span class="o">/</span><span class="p">(</span><span class="n">fred</span><span class="o">|</span><span class="n">barney</span><span class="p">)</span><span class="o">/</span><span class="err">\</span><span class="n">u</span><span class="err">\</span><span class="n">L</span><span class="err">$</span><span class="mi">1</span><span class="o">/</span><span class="n">ig</span><span class="p">;</span><span class="o">=&gt;</span><span class="s">&quot;I saw Fred with Barney .&quot;</span>
</pre></div>


<p>默认情况下，\E,\L会影响到后面全部的替换字符串，你可以用\E关闭大小写转换功能。</p>
<h3>split操作符</h3>
<p>对于使用制表符，冒号，空白或任意符号分隔不同字段的字符串来说，用split提取字段相当方便。只要将分隔符写成模式（通常是很简单的正则表达式）:</p>
<div class="highlight"><pre><span class="n">my</span> <span class="err">@</span><span class="n">fields</span> <span class="o">=</span> <span class="n">split</span> <span class="o">/:/</span><span class="p">,</span><span class="s">&quot;abc:def:g:h&quot;</span><span class="p">;</span> <span class="o">=&gt;</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="s">&quot;def&quot;</span><span class="p">,</span><span class="s">&quot;g&quot;</span><span class="p">,</span><span class="s">&quot;h&quot;</span><span class="p">);</span>
<span class="n">my</span> <span class="err">@</span><span class="n">fields</span> <span class="o">=</span> <span class="n">split</span> <span class="o">/:/</span><span class="p">,</span><span class="s">&quot;abc:def::g:h&quot;</span><span class="p">;</span> <span class="o">=&gt;</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">,</span><span class="s">&quot;def&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;g&quot;</span><span class="p">,</span><span class="s">&quot;h&quot;</span><span class="p">);</span>
<span class="n">my</span> <span class="err">@</span><span class="n">fields</span> <span class="o">=</span> <span class="n">split</span> <span class="o">/:/</span><span class="p">,</span><span class="s">&quot;:::a:b:c:::&quot;</span><span class="p">;</span> <span class="o">=&gt;</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">);</span>
</pre></div>


<p>如果两个分隔符连在一起，就会产生空字段。并且split会保留开头的空字段，而会舍弃结尾处的空字段.
利用split的/\s+/模式根据空白符分隔字段也是比较常见的做法：</p>
<div class="highlight"><pre><span class="k">my</span> <span class="nv">$some_input</span> <span class="o">=</span> <span class="s">&quot;this is a \t     test.\n&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@args</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">/\s+/</span><span class="p">,</span><span class="nv">$some_input</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@fields</span> <span class="o">=</span> <span class="nb">split</span><span class="p">;</span>   <span class="sr">&lt;=&gt;</span> <span class="nb">split</span> <span class="sr">/\s+/</span><span class="p">,</span><span class="nv">$_</span><span class="p">;</span>
</pre></div>


<h3>join函数</h3>
<p>与split刚好相反，join函数将片段用指定的连接符合成一个字符串。</p>
<div class="highlight"><pre><span class="k">my</span> <span class="nv">$x</span> <span class="o">=</span> <span class="nb">join</span> <span class="s">&quot;:&quot;</span><span class="p">,(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span> <span class="o">=&gt;</span><span class="s">&quot;4:5:6:7:8&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@values</span> <span class="o">=</span> <span class="nb">split</span> <span class="sr">/:/</span><span class="p">,</span><span class="nv">$x</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$z</span> <span class="o">=</span> <span class="nb">join</span> <span class="s">&quot;-&quot;</span><span class="p">,</span><span class="nv">@values</span><span class="p">;</span>
</pre></div>


<p>join的列表至少有两个元素，否则不起作用。join经常与split联合使用。</p>
<h3>列表上下文中的m//</h3>
<p>在列表上下文中庸模式匹配，如果模式匹配成功，那么返回的是所有捕获变量的列表，如果失败，返回空列表：</p>
<div class="highlight"><pre><span class="nv">$_</span> <span class="o">=</span> <span class="s">&quot;hello there, neighbor!&quot;</span><span class="p">;</span>
<span class="k">my</span><span class="p">(</span><span class="nv">$first</span><span class="p">,</span><span class="nv">$second</span><span class="p">,</span><span class="nv">$third</span><span class="p">)</span> <span class="o">=</span> <span class="sr">/(\S+) (\S+), (\S+)/</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$text</span> <span class="o">=</span> <span class="s">&quot;Fred dropped a 5 ton granite block on Mr.Slate&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">@words</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$text</span> <span class="o">=~</span><span class="sr"> /([a-z]+)/gi</span><span class="p">);</span>
<span class="nv">@words</span> <span class="o">=&gt;</span> <span class="n">Fred</span> <span class="n">dropped</span> <span class="n">a</span> <span class="n">ton</span> <span class="n">granite</span> <span class="n">block</span> <span class="n">on</span> <span class="n">Mr</span> <span class="n">Slate</span>

<span class="k">my</span> <span class="nv">$data</span> <span class="o">=</span> <span class="s">&quot;barney rubble fred flintstone wilma flintstone&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">%last_name</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$data</span> <span class="o">=~</span><span class="sr"> /(\w+)\s+(\w+)/g</span><span class="p">);</span>
</pre></div>


<h3>非贪婪量词</h3>
<p>到目前为止，我们看到的量词+,*,?,{4,10}都是贪婪的。所谓贪婪，就是在保证整体匹配的前提下，它们会尽量匹配长字符串，实在不行才会吐出一点。
举个例子：</p>
<div class="highlight"><pre><span class="o">/</span><span class="n">fred</span><span class="p">.</span><span class="o">+</span><span class="n">barney</span><span class="o">/</span><span class="p">,</span><span class="err">&#39;</span><span class="n">fred</span> <span class="n">and</span> <span class="n">barney</span> <span class="n">went</span> <span class="n">bowling</span> <span class="n">last</span> <span class="n">night</span><span class="p">;</span>
</pre></div>


<p>贪婪量词的匹配过程是这样的：首先匹配到fred，然后.+会匹配剩下所有的字符，直到最后的night，现在轮到匹配barney了，但是由于已经匹配到了结尾，没有多余的字符可供匹配了，但是由于.+少匹配一个字符也算匹配成功，所以它打算后退一步看看，于是吐出最后匹配到的字符t（虽然它很贪婪，但是为了顾全大局，并让整体模式尽可能匹配成功，它愿意回退。）。这样，正则表达式引擎会一直进行回溯，直到成功匹配，也可能最后也不能做到整体匹配，此时匹配失败。</p>
<p>由此可见，贪婪量词可能会经历繁琐的回溯过程，影响效率。</p>
<p>于是，每个贪婪量词都有一个非贪婪版本，+?,*?,??,{4,10}?,它会在整体匹配的情况下，匹配越少字符越好。</p>
<div class="highlight"><pre><span class="o">/</span><span class="n">fred</span><span class="p">.</span><span class="o">+?</span><span class="n">barney</span><span class="o">/</span><span class="p">,</span><span class="err">&#39;</span><span class="n">fred</span> <span class="n">and</span> <span class="n">barney</span> <span class="n">went</span> <span class="n">bowling</span> <span class="n">last</span> <span class="n">night</span><span class="p">;</span>
</pre></div>


<p>现在，匹配过程变成这样了：先匹配上fred然后往后匹配一个字符，接下匹配模式的剩余部分barney，发现没匹配上，于是.+?再多匹配一个字符，重复上述过程，直到整体匹配。</p>
<p>贪婪量词和非贪婪量词哪个效率高取决于要处理的数据。在上述例子中，如果fred和barney分别位于字符串的开头和结尾，那么贪婪量词更有效率；如果相隔很近，那么非贪婪量词更高效。</p>
<p>再看一个例子,假设你有一个HTML文本，你要去除<BOLD></BOLD>这样的标记，并取得其内容：</p>
<div class="highlight"><pre><span class="nx">I</span> <span class="nb">am</span> <span class="nx">talking</span> <span class="nx">about</span> <span class="nx">the</span> <span class="nx">cartoon</span> <span class="k">with</span> <span class="nx">fred</span> <span class="ow">and</span> <span class="o">&lt;</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="nx">Wilma</span><span class="o">&lt;/</span><span class="nx">BOLD</span><span class="o">&gt;!</span>
<span class="nb">s</span><span class="err">#</span><span class="o">&lt;</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">.</span><span class="o">*</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">BOLD</span><span class="o">&gt;!</span><span class="err">#$</span><span class="mi">1</span><span class="vi">#g</span><span class="p">;</span>
</pre></div>


<p>这样做在某些情况下会出问题，因为*太贪心了，考虑下面的文本：</p>
<div class="highlight"><pre><span class="nx">I</span> <span class="nb">am</span> <span class="nx">talking</span> <span class="nx">about</span> <span class="nx">the</span> <span class="nx">cartoon</span> <span class="k">with</span> <span class="nx">fred</span> <span class="ow">and</span> <span class="o">&lt;</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="nx">Wilma</span><span class="o">&lt;/</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="p">,</span> <span class="ow">not</span> <span class="o">&lt;</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="nx">Velma</span><span class="o">&lt;/</span><span class="nx">BOLD</span><span class="o">&gt;!</span>
</pre></div>


<p>这时，模式会从第一个<BOLD>一直匹配到最后的</BOLD>，把中间部分全部取出来。事实上，我们应该使用非贪婪量词，这样就可以取出每个<BOLD></BOLD>对的内容了。</p>
<div class="highlight"><pre><span class="nb">s</span><span class="err">#</span><span class="o">&lt;</span><span class="nx">BOLD</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">.</span><span class="o">*</span><span class="err">？</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">BOLD</span><span class="o">&gt;!</span><span class="err">#$</span><span class="mi">1</span><span class="vi">#g</span><span class="p">;</span>
</pre></div>


<h3>跨行模式匹配</h3>
<p>传统的正则表达式都是用来匹配单行文本，事实上，单行文本和多行文本并无本质区别，只要在单行文本里加入换行符\n，就可以变成多行文本了。我们知道^,\$都是匹配字符串的绝对开头和绝对结尾，如果在模式后面加上/m修饰，就可以让它们匹配字符串内的每一行。</p>
<div class="highlight"><pre><span class="nb">open</span> <span class="n">FILE</span><span class="p">,</span><span class="nv">$file_name</span>
    <span class="ow">or</span> <span class="nb">die</span> <span class="s">&quot;can not open $file_name : $!\n&quot;</span><span class="p">;</span>
<span class="k">my</span> <span class="nv">$lines</span> <span class="o">=</span> <span class="nb">join</span> <span class="s">&#39;&#39;</span><span class="p">,</span><span class="sr">&lt;FILE&gt;</span><span class="p">;</span>
<span class="nv">$lines</span> <span class="o">=~</span> <span class="sr">s/^/$file_name : /gm</span><span class="p">;</span>
</pre></div>


<h3>一次更新多个文件,变量$^I</h3>
<div class="highlight"><pre><span class="nb">chomp</span><span class="p">(</span> <span class="k">my</span> <span class="nv">$date</span> <span class="o">=</span> <span class="s">&#39;date&#39;</span><span class="p">);</span>
<span class="vg">$^I</span> <span class="o">=</span><span class="s">&quot;.bak&quot;</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">){</span>
    <span class="sr">s/^Author:.*/Author: Randal L. Schwartz/</span><span class="p">;</span>
    <span class="sr">s/^Phone:.*\n//</span><span class="p">;</span>
    <span class="sr">s/^Date:.*/Date: $date/</span><span class="p">;</span>
    <span class="k">print</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>程序里变量\$^I起了关键的作用，这个变量的默认值是undef，也不会对程序造成任何影响，但如果将其赋值成某个字符串，钻石操作符&lt;&gt;就会比平常有更多的魔力，该字符串会变成备份文件的扩展名。 例如现在正好打开了一个文件fred09.dat，此时perl会将文件重命名为fred09.dat.bak，然后创建一个新的空文件fred09.dat，现在钻石操作符会把默认的输出设定为这个新打开的文件。实际上，perl并没有编辑任何文件，只是创建了一个修改过的拷贝。如果把\$^I设为空字符串，则不会有备份文件。</p>
<h3>从命令行直接编辑</h3>
<p>perl的命令行选项设计十分巧妙，让你只用极少的按键就能建立一个完整的程序。</p>
<div class="highlight"><pre><span class="n">perl</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">i</span><span class="p">.</span><span class="n">bak</span> <span class="o">-</span><span class="n">w</span> <span class="o">-</span><span class="n">e</span> <span class="err">&#39;</span><span class="n">s</span><span class="o">/</span><span class="n">Randall</span><span class="o">/</span><span class="n">Randal</span><span class="o">/</span><span class="n">g</span><span class="err">&#39;</span> <span class="n">fred</span><span class="o">*</span><span class="p">.</span><span class="n">dat</span>
</pre></div>


<p>-p选项可以让perl自动生成一小段程序，看起来类似于：</p>
<div class="highlight"><pre><span class="k">while</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">){</span>
    <span class="n">print</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>如果不需要太多功能，可以选用-n选项，这样可以把自动执行的print语句去掉。</p>
<p>-i.bak作用跟\$^I =".bak"是一样的，如果你不想备份，直接列出-i，但不加扩展名。</p>
<p>-e选项告诉perl后面是可供执行的程序代码。也就是说，s/Randall/Randal/g这个字符串会被直接当成perl程序代码，由于我们目前已经有个while循环，所以这段程序嗲吗会被放到print前面的位置，可以有多个-e选项，完成多段程序代码。因此上面的命令行程序其实相当于下面的代码：</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="c1">#!/usr/bin/perl -w</span>
<span class="vg">$^I</span> <span class="o">=</span> <span class="s">&quot;.bak&quot;</span><span class="p">;</span>
<span class="k">while</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">){</span>
    <span class="sr">s/Randall/Randal/g</span><span class="p">;</span>
    <span class="k">print</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>
                </div><!-- /.entry-content -->
                <div class="comments">
                <h2>Comments !</h2>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                           var disqus_identifier = "Perl的正则表达式,Perl.html";
                           (function() {
                                var dsq = document.createElement('script');
                                dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = 'http://buptlixin.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] ||
                                 document.getElementsByTagName('body')[0]).appendChild(dsq);
                          })();
                        </script>
                </div>
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="http://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="http://python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="http://jinja.pocoo.org/"><i class="icon-external-link"></i>Jinja2</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="/" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="http://www.v2ex.com/member/buptlee"><i class="icon-V2EX-sign icon-large"></i>V2EX</a></li>
    <li><a href="http://douban.com/people/77726008"><i class="icon-豆瓣-sign icon-large"></i>豆瓣</a></li>
    <li><a href="http://github.com/Xiaoxin2009"><i class="icon-Github-sign icon-large"></i>Github</a></li>
    <li><a href="http://stackoverflow.com/users/3373388/bupt-xiaoxin"><i class="icon-Stackoverflow-sign icon-large"></i>Stackoverflow</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="/category/fen-bu-shi.html">
    <i class="icon-folder-open icon-large"></i>分布式
</a>
</li>
<li>
<a href="/category/java.html">
    <i class="icon-folder-open icon-large"></i>JAVA
</a>
</li>
<li>
<a href="/category/machine-learning.html">
    <i class="icon-folder-open icon-large"></i>Machine Learning
</a>
</li>
<li>
<a href="/category/perl.html">
    <i class="icon-folder-open icon-large"></i>Perl
</a>
</li>
<li>
<a href="/category/python.html">
    <i class="icon-folder-open icon-large"></i>Python
</a>
</li>
<li>
<a href="/category/scala.html">
    <i class="icon-folder-open icon-large"></i>Scala
</a>
</li>
<li>
<a href="/category/shu-ju-ku.html">
    <i class="icon-folder-open icon-large"></i>数据库
</a>
</li>
<li>
<a href="/category/technology.html">
    <i class="icon-folder-open icon-large"></i>Technology
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<li class="tag-3">
    <a href="/tag/storm.html">
        <i class="icon-tag icon-large"></i>Storm
    </a>
</li>
<li class="tag-3">
    <a href="/tag/zheng-ze-biao-da-shi.html">
        <i class="icon-tag icon-large"></i>正则表达式
    </a>
</li>
<li class="tag-4">
    <a href="/tag/machine-learning.html">
        <i class="icon-tag icon-large"></i>Machine Learning
    </a>
</li>
<li class="tag-4">
    <a href="/tag/hadoop.html">
        <i class="icon-tag icon-large"></i>Hadoop
    </a>
</li>
<li class="tag-1">
    <a href="/tag/perl.html">
        <i class="icon-tag icon-large"></i>Perl
    </a>
</li>
<li class="tag-1">
    <a href="/tag/scala.html">
        <i class="icon-tag icon-large"></i>scala
    </a>
</li>
<li class="tag-4">
    <a href="/tag/functional-programming.html">
        <i class="icon-tag icon-large"></i>functional programming
    </a>
</li>
<li class="tag-4">
    <a href="/tag/svm.html">
        <i class="icon-tag icon-large"></i>SVM
    </a>
</li>
<li class="tag-4">
    <a href="/tag/mongodb.html">
        <i class="icon-tag icon-large"></i>MongoDB
    </a>
</li>
<li class="tag-4">
    <a href="/tag/hash.html">
        <i class="icon-tag icon-large"></i>Hash
    </a>
</li>
<li class="tag-3">
    <a href="/tag/sql.html">
        <i class="icon-tag icon-large"></i>SQL
    </a>
</li>
<li class="tag-4">
    <a href="/tag/github.html">
        <i class="icon-tag icon-large"></i>Github
    </a>
</li>
<li class="tag-4">
    <a href="/tag/hdfs.html">
        <i class="icon-tag icon-large"></i>HDFS
    </a>
</li>
<li class="tag-4">
    <a href="/tag/python.html">
        <i class="icon-tag icon-large"></i>Python
    </a>
</li>
<li class="tag-4">
    <a href="/tag/nosql.html">
        <i class="icon-tag icon-large"></i>NoSQL
    </a>
</li>
<li class="tag-4">
    <a href="/tag/functional-programing.html">
        <i class="icon-tag icon-large"></i>functional programing
    </a>
</li>
<li class="tag-1">
    <a href="/tag/java.html">
        <i class="icon-tag icon-large"></i>java
    </a>
</li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
	var pageTracker = _gat._getTracker("UA-50849437-1");
pageTracker._trackPageview();
} catch(err) {}</script>
<script type="text/javascript">
    var disqus_shortname = 'buptlixin';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/theme/js/jquery-1.7.2.min.js"></script>
    <script src="/theme/js/bootstrap.min.js"></script>
  </body>
</html>